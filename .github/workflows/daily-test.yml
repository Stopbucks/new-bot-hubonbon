name: Daily Routine & RSS Test

on:
  schedule:
    # 1. åŸæœ‰çš„ AI é—œéµå­—æ¸¬è©¦ (15:50 TW = 07:50 UTC)
    - cron: '50 7 * * *'
    
    # 2. æ–°å¢ï¼šæ³•åœ‹ RSS æ¸¬è©¦ (17:50 TW = 09:50 UTC)
    - cron: '50 9 * * *'

    # 3. æ–°å¢ï¼šè‹±åœ‹ RSS æ¸¬è©¦ (18:10 TW = 10:10 UTC)
    - cron: '10 10 * * *'
  
  # å…è¨±æ‰‹å‹•æ¸¬è©¦
  workflow_dispatch:

jobs:
  trigger-tasks:
    runs-on: ubuntu-latest
    steps:
      - name: Check Time & Trigger Appropriate Task
        run: |
          current_hour=$(date +'%H')
          echo "Current UTC Hour is: $current_hour"

          if [ "$current_hour" -eq 7 ]; then
            echo "ğŸš€ Triggering AI Keyword Search..."
            curl -X GET https://my-news-bot-77zr.onrender.com/test-trigger
          
          elif [ "$current_hour" -eq 9 ]; then
            echo "ğŸ‡«ğŸ‡· Triggering France RSS..."
            curl -X GET "https://my-news-bot-77zr.onrender.com/rss-test?region=FR"
            
          elif [ "$current_hour" -eq 10 ]; then
            echo "ğŸ‡¬ğŸ‡§ Triggering UK RSS..."
            curl -X GET "https://my-news-bot-77zr.onrender.com/rss-test?region=GB"
            
          else
            echo "âš ï¸ Manual trigger detected, running default AI test..."
            curl -X GET https://my-news-bot-77zr.onrender.com/test-trigger
          fi